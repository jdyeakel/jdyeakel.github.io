<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Demo 1: Cobweb Diagrams &#8211; Yeakel Group</title>

<meta name="keywords" content="about, Jekyll, theme, responsive">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Demo 1: Cobweb Diagrams">




<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="//jdyeakel.github.io/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Demo 1: Cobweb Diagrams">

<meta property="og:url" content="//jdyeakel.github.io/teaching/ecodyn156/demo1_cobweb/">
<meta property="og:site_name" content="Yeakel Group">





<link rel="canonical" href="//jdyeakel.github.io/teaching/ecodyn156/demo1_cobweb/">
<link href="//jdyeakel.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Yeakel Group Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="//jdyeakel.github.io/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="//jdyeakel.github.io/assets/js/vendor/html5shiv.min.js"></script>
	<script src="//jdyeakel.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="//jdyeakel.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="//jdyeakel.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="//jdyeakel.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="//jdyeakel.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="//jdyeakel.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="//jdyeakel.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="//jdyeakel.github.io/images/apple-touch-icon-144x144-precomposed.png">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;600&display=swap" rel="stylesheet">

<!-- Mathjax Support -->
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>

<body class="page">

<script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="//jdyeakel.github.io">Yeakel Group</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
					    
					    <li><a href="//jdyeakel.github.io/people/" >People</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/diversity/" >Diversity</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/research/" >Research</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/teaching/" >Teaching</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/CV/" >Publications</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/posts/" >Posts</a></li>
					  
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
	  


	<img src="//jdyeakel.github.io/images/ecology/elephants_small.jpg" class="bio-photo" alt="Justin D. Yeakel bio photo"></a>

<h3>Fundamentals of Ecology</h3>
<p>"The Earth is what we all have in common"<br> -Wendell Barry</p>
<!-- <a href="mailto:jdyeakel@gmail.com" class="author-social" target="_blank"><i class="fa fa-envelope-square"></i> Email</a>





<a href="http://github.com/jdyeakel" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>






 -->

 </div>
  <article>
    <h1>Demo 1: Cobweb Diagrams</h1>
    <div class="article-wrap">
      <p><a href="//jdyeakel.github.io/teaching/ecology">&lt; Back to Course Page</a><br />
<br /></p>

<h2 id="cobweb-diagrams">Cobweb Diagrams</h2>

<p>For the continuous-time logistic equation, we were able to learn a lot about the dynamics of the system by graphically analyzing the ‘flow’ when we plotted \({\rm d}N/{\rm dt}\) (on the y-axis) versus \(N\) (on the x-axis). There is an analogous method for the discrete time logistic equation, however there is a little more to it that requires careful consideration.</p>

<p>For the discrete-time system, we will graphically analyze the plot of \(N(t+1)\) (on the y-axis) as a function of \(N(t)\) (on the x-axis). As with the continuous-time equation, this produces a parabola. The parabola represents the mapping from \(N(t)\) to \(N(t+1)\). In other words, if our population is at value \(N(t)\), to find the next value at time \(t+1\), we identify the value of \(N(t)\) on the x-axis, draw a vertical line up to the parabola, and this gives us the value at \(N(t+1)\). We then reiterate the process. We can make life simpler for ourselves if we also draw the 1:1 line in the same plot (where \(N(t) = N(t+1)\)). Instead of going back to the x-axis for every \(N(t)\) to draw the vertical line up to the parabola (giving us \(N(t+1)\)), we can simply draw a horizontal line to the 1:1 line (resetting \(N(t+1)\) to \(N(t)\)), and than a vertical line up or down to the parabola to get at the next value of \(N(t+1)\). Below we observe the process for tracing the dynamics of a discrete time system in this way:</p>
<ul>
  <li>First, find \(N(t)\) on the x-axis</li>
  <li>Draw a vertical line up to the parabola. This is \(N(t+1)\)</li>
  <li>Draw a horizontal line over to the 1:1 line. This resets \(N(t)\) along the x-axis</li>
  <li>Draw a vertical line <em>up</em> or <em>down</em> to the parabola. This gives us \(N(t+1)\)</li>
  <li>Draw a horizontal line over to the 1:1 axis</li>
  <li>Repeat, repeat, repeat!</li>
</ul>

<p>The above algorithm constitutes what we call a <em>cobweb diagram</em>. We implement this algorithm via simulation in the code block below. Run the same parameter sets that you encoded above into the cobweb diagram below. <strong><em>Make sure you understand what the cobweb diagram is showing.</em></strong> Confirm that the time-simulation of the discrete-logistic equation and the cobweb diagram are telling us the same thing.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">logistic.cobweb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">rd</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">N0</span><span class="p">,</span><span class="n">tmax</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numeric</span><span class="p">(</span><span class="n">tmax</span><span class="p">)</span><span class="w">
        </span><span class="n">N</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N0</span><span class="w">
        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="n">tmax</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">Nt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rd</span><span class="o">*</span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">]</span><span class="o">/</span><span class="n">K</span><span class="p">)</span><span class="w">
            </span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nt</span><span class="w"> 
        </span><span class="p">}</span><span class="w">
        </span><span class="n">Ntx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="nf">max</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="m">1+0.5</span><span class="p">),</span><span class="n">length.out</span><span class="o">=</span><span class="m">100</span><span class="p">)</span><span class="w">
        </span><span class="n">Nty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ntx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rd</span><span class="o">*</span><span class="n">Ntx</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Ntx</span><span class="o">/</span><span class="n">K</span><span class="p">)</span><span class="w">
        </span><span class="n">xymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="w">
        </span><span class="n">plot</span><span class="p">(</span><span class="n">Ntx</span><span class="p">,</span><span class="n">Nty</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s2">"Population size N(t)"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"Population size N(t+1)"</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">xymax</span><span class="p">),</span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">xymax</span><span class="p">))</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">seq</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="n">seq</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="p">(</span><span class="n">tmax</span><span class="m">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="c1">#draw segments</span><span class="w">
            </span><span class="n">segments</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="p">],</span><span class="n">y0</span><span class="o">=</span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="p">],</span><span class="n">x1</span><span class="o">=</span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="p">],</span><span class="n">y1</span><span class="o">=</span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="m">+1</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span><span class="w">
            </span><span class="n">segments</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="p">],</span><span class="n">y0</span><span class="o">=</span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="m">+1</span><span class="p">],</span><span class="n">x1</span><span class="o">=</span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="m">+1</span><span class="p">],</span><span class="n">y1</span><span class="o">=</span><span class="n">N</span><span class="p">[</span><span class="n">t</span><span class="m">+1</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">logistic.cobweb</span><span class="p">(</span><span class="n">rd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">N0</span><span class="o">=</span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">tmax</span><span class="o">=</span><span class="m">40</span><span class="p">)</span><span class="w">

</span></code></pre></div></div>

<iframe width="100%" height="500" src="https://rdrr.io/snippets/embed/?code=%23Paste%20code%20here" frameborder="0"></iframe>

<blockquote>
  <h3 id="diving-deeper">Diving Deeper</h3>
  <ol>
    <li>Across intervals of 0.1, at what value of \(r_d\) do the dynamics become cyclic? Unpredictable?</li>
    <li>Compare <code class="language-plaintext highlighter-rouge">rd=1.8</code> to <code class="language-plaintext highlighter-rouge">rd=2.0</code>. What is the primary difference between these outcomes. Compare both the results of the cobweb diagram and the \(N(t)\) vs. \(t\) plot to establish your interpretation of what is going on.</li>
    <li>Do we observe cycles or chaotic dynamics in the continuous-time logistic model? <strong><em>(Below is the code block from Section 7 where we assessed continuous-time logistic dynamics, which you can use for reference)</em></strong></li>
    <li>Given these differences, what are the long-term implications for discrete-time vs. continuous-time population dynamics?</li>
    <li>What ecological factors might promote continuous- vs. discrete-time population dynamics?</li>
  </ol>
</blockquote>

<h2 id="compare-the-continuous--and-discrete-time-systems-directly">Compare the Continuous- and Discrete-time systems directly</h2>

<p>This code block allows us to directly compare the temporal dynamics of continuous-time and discrete-time logistic populations directly. Use this to inform your answers to the above questions.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">library</span><span class="p">(</span><span class="n">deSolve</span><span class="p">)</span><span class="w">
    </span><span class="n">pop.combined</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">N0</span><span class="p">,</span><span class="n">tmax</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="c1">#Continuous model</span><span class="w">
        </span><span class="n">yini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N0</span><span class="p">)</span><span class="w">
        </span><span class="n">fmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">parms</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">with</span><span class="p">(</span><span class="n">as.list</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">dN</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">K</span><span class="p">))</span><span class="w">
            </span><span class="nf">list</span><span class="p">(</span><span class="n">dN</span><span class="p">)</span><span class="w">
        </span><span class="p">})</span><span class="w">
        </span><span class="p">}</span><span class="w">
        
        </span><span class="n">times</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="w"> 
        </span><span class="n">out</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ode</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yini</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmap</span><span class="p">,</span><span class="w"> </span><span class="n">parms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w">
        
        </span><span class="c1"># Discrete model</span><span class="w">
        </span><span class="n">Nd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numeric</span><span class="p">(</span><span class="n">tmax</span><span class="p">)</span><span class="w">
        </span><span class="n">Nd</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N0</span><span class="w">
        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="n">tmax</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">Ndt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nd</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r</span><span class="o">*</span><span class="n">Nd</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Nd</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">]</span><span class="o">/</span><span class="n">K</span><span class="p">)</span><span class="w">
            </span><span class="n">Nd</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ndt</span><span class="w"> 
        </span><span class="p">}</span><span class="w">
        </span><span class="n">maxN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">Nd</span><span class="p">,</span><span class="n">out</span><span class="p">[,</span><span class="m">2</span><span class="p">]))</span><span class="w">
        </span><span class="n">plot</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s1">'Time'</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s1">'Population N(t)'</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">maxN</span><span class="p">))</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">Nd</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">pop.combined</span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="n">K</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="n">N0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">40</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<iframe width="100%" height="500" src="https://rdrr.io/snippets/embed/?code=%23Paste%20code%20here" frameborder="0"></iframe>

<h2 id="displacement-dynamics-near-a-steady-state">Displacement dynamics near a steady state</h2>

<p>So far, the cobweb diagram has helped us <em>see</em> how a discrete-time system maps \(N(t)\) to \(N(t+1)\). Here we take the next step and make that “mapping” quantitative by focusing on what happens <strong>near a steady state</strong>.</p>

<p>Suppose the system has a fixed point \(n^*\) (a steady state), meaning</p>

\[\begin{equation}
n^* = f(n^*).  
\end{equation}\]

<p>Now imagine the population is not exactly at \(n^*\), but <em>very close</em> to it. We write the current population size as</p>

\[\begin{equation}
N(t) = n^* + \epsilon(t),
\end{equation}\]

<p>where \(\epsilon(t)\) is the displacement from the steady state. This displacement can be positive (above \(n^*\)) or negative (below \(n^*\)).</p>

<p>The central question is: <em>does the displacement shrink or grow over time?</em></p>

<hr />

<p>If \(\epsilon(t)\) gets smaller as \(t\) increases, the system is returning to the steady state and \(n^*\) is <strong>stable</strong>. If \(\epsilon(t)\) grows, the system is moving away and \(n^*\) is <strong>unstable</strong>. And in discrete time, there is an additional wrinkle: the sign of \(\epsilon(t)\) can flip from one time step to the next, producing oscillatory convergence (or oscillatory divergence).</p>

<p>In the code demo, we simulate the logistic difference equation and explicitly track \(\epsilon(t)=N(t)-n^*\). We then compare the “true” displacement dynamics to what we would expect from the local linear approximation (introduced next). The goal is to confirm—numerically and visually—that near a steady state, the behavior of the full nonlinear model is well summarized by a single number: the local slope \(\lambda\).</p>

<hr />

<h3 id="taylor-approximation-and-the-origin-of-lambda">Taylor approximation and the origin of \(\lambda\)</h3>

<p>The displacement idea becomes powerful once we connect it to a standard tool: a Taylor approximation.</p>

<p>Start again from the general discrete-time model</p>

\[N(t+1) = f(N(t)).\]

<p>If we are close to a steady state \(n^*\), then \(N(t)=n^*+\epsilon(t)\) with \(\epsilon(t)\) small. We want to express the next displacement \(\epsilon(t+1)\) in terms of the current displacement \(\epsilon(t)\). Using a first-order Taylor approximation of \(f\) near \(n^*\),</p>

\[f(n^*+\epsilon) \approx f(n^*) + f'(n^*)\,\epsilon.\]

<p>Because \(n^*\) is a fixed point, \(f(n^*)=n^*\). Substituting into the displacement definition,</p>

\[\epsilon(t+1) = N(t+1)-n^* = f(n^*+\epsilon(t)) - n^*
\approx \big(n^* + f'(n^*)\,\epsilon(t)\big) - n^*
= f'(n^*)\,\epsilon(t).\]

<p>This motivates the definition</p>

\[\lambda = f'(n^*),\]

<p>so that, near the steady state,</p>

\[\epsilon(t+1) \approx \lambda\,\epsilon(t).\]

<p>This is the entire stability test in one line:</p>

<ul>
  <li>If \(-1&lt;\lambda&lt;1\), displacement shrinks and the steady state is <strong>stable</strong>.</li>
  <li>If \(\lambda&lt;-1\) or \(\lambda&gt;1\), displacement grows and the steady state is <strong>unstable</strong>.</li>
  <li>If \(\lambda&gt;0\), the displacement tends to stay on the same side of \(n^*\).</li>
  <li>If \(\lambda&lt;0\), the displacement tends to switch sides each step (oscillations).</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">############################################################</span><span class="w">
</span><span class="c1">## Displacement + Taylor approximation near a steady state  ##</span><span class="w">
</span><span class="c1">############################################################</span><span class="w">

</span><span class="c1"># Discrete-time logistic map (same form as cobweb code)</span><span class="w">
</span><span class="n">f_logistic</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rd</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="o">/</span><span class="n">K</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># One-step linearization near a steady state n*</span><span class="w">
</span><span class="c1"># epsilon(t+1) ≈ lambda * epsilon(t), where lambda = f'(n*)</span><span class="w">
</span><span class="n">lambda_logistic</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">nstar</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c1"># f'(N) = 1 + rd - 2*rd*N/K</span><span class="w">
  </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rd</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">2</span><span class="o">*</span><span class="n">rd</span><span class="o">*</span><span class="n">nstar</span><span class="o">/</span><span class="n">K</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># Identify fixed points for this model:</span><span class="w">
</span><span class="c1"># n* = 0 and n* = K (for rd &gt; 0)</span><span class="w">
</span><span class="n">fixed_points_logistic</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">)</span><span class="w">

</span><span class="c1">############################################################</span><span class="w">
</span><span class="c1">## Demo: compare "true displacement" vs linear prediction  ##</span><span class="w">
</span><span class="c1">############################################################</span><span class="w">

</span><span class="n">displacement.demo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">rd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.8</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> 
                              </span><span class="n">nstar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w">          </span><span class="c1"># choose 0 or K</span><span class="w">
                              </span><span class="n">eps0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span><span class="p">,</span><span class="w">        </span><span class="c1"># initial displacement: N0 = n* + eps0</span><span class="w">
                              </span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  
  </span><span class="c1"># Setup</span><span class="w">
  </span><span class="n">N_true</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">numeric</span><span class="p">(</span><span class="n">tmax</span><span class="p">)</span><span class="w">
  </span><span class="n">eps_true</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">numeric</span><span class="p">(</span><span class="n">tmax</span><span class="p">)</span><span class="w">
  </span><span class="n">eps_lin</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">numeric</span><span class="p">(</span><span class="n">tmax</span><span class="p">)</span><span class="w">
  
  </span><span class="n">N_true</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nstar</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eps0</span><span class="w">
  </span><span class="n">eps_true</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eps0</span><span class="w">
  
  </span><span class="n">lam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lambda_logistic</span><span class="p">(</span><span class="n">nstar</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">)</span><span class="w">
  </span><span class="n">eps_lin</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eps0</span><span class="w">
  
  </span><span class="c1"># Iterate</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="n">tmax</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">N_true</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">f_logistic</span><span class="p">(</span><span class="n">N_true</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">],</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">)</span><span class="w">
    </span><span class="n">eps_true</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">N_true</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nstar</span><span class="w">
    </span><span class="n">eps_lin</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lam</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">eps_lin</span><span class="p">[</span><span class="n">t</span><span class="m">-1</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
  
  </span><span class="c1"># Plot displacement over time (true vs linearized)</span><span class="w">
  </span><span class="n">tt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">tmax</span><span class="w">
  </span><span class="n">ymax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">eps_true</span><span class="p">,</span><span class="w"> </span><span class="n">eps_lin</span><span class="p">)))</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="w"> </span><span class="n">eps_true</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w">
       </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"Time t"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="nf">expression</span><span class="p">(</span><span class="n">epsilon</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">N</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">n</span><span class="o">^</span><span class="s2">"*"</span><span class="p">),</span><span class="w">
       </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="n">ymax</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="p">))</span><span class="w">
  </span><span class="n">lines</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="w"> </span><span class="n">eps_lin</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
  </span><span class="n">abline</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
  </span><span class="n">legend</span><span class="p">(</span><span class="s2">"topright"</span><span class="p">,</span><span class="w">
         </span><span class="n">legend</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"True displacement"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Linear approx: eps(t)=lambda^t eps(0)"</span><span class="p">),</span><span class="w">
         </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">16</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">bty</span><span class="o">=</span><span class="s2">"n"</span><span class="p">)</span><span class="w">
  
  </span><span class="c1"># Print key quantities</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"\n--- Displacement / linearization summary ---\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"Model: N(t+1) = N(t) + rd*N(t)*(1 - N(t)/K)\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"Chosen fixed point n* ="</span><span class="p">,</span><span class="w"> </span><span class="n">nstar</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"rd ="</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="s2">"  K ="</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"lambda = f'(n*) ="</span><span class="p">,</span><span class="w"> </span><span class="n">lam</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"Stability criterion: |lambda| &lt; 1 (stable), |lambda| &gt; 1 (unstable)\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"Here: |lambda| ="</span><span class="p">,</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">lam</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n\n"</span><span class="p">)</span><span class="w">
  
  </span><span class="nf">invisible</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">N_true</span><span class="o">=</span><span class="n">N_true</span><span class="p">,</span><span class="w"> </span><span class="n">eps_true</span><span class="o">=</span><span class="n">eps_true</span><span class="p">,</span><span class="w"> </span><span class="n">eps_lin</span><span class="o">=</span><span class="n">eps_lin</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="o">=</span><span class="n">lam</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1">############################################################</span><span class="w">
</span><span class="c1">## Quick-use examples                                     ##</span><span class="w">
</span><span class="c1">############################################################</span><span class="w">

</span><span class="c1"># 1) Stable approach to K (no sign-flip if lambda &gt; 0)</span><span class="w">
</span><span class="c1"># displacement.demo(rd=1.2, K=1, nstar=1, eps0=0.2, tmax=25)</span><span class="w">

</span><span class="c1"># 2) Stable but oscillatory approach to K (lambda &lt; 0, |lambda|&lt;1)</span><span class="w">
</span><span class="c1"># displacement.demo(rd=1.8, K=1, nstar=1, eps0=0.2, tmax=25)</span><span class="w">

</span><span class="c1"># 3) Borderline at the onset of 2-cycle (lambda = -1 at rd=2 for n*=K)</span><span class="w">
</span><span class="c1"># displacement.demo(rd=2.0, K=1, nstar=1, eps0=0.05, tmax=25)</span><span class="w">

</span><span class="c1"># 4) Unstable (|lambda|&gt;1) at K for rd &gt; 2</span><span class="w">
</span><span class="c1"># displacement.demo(rd=2.1, K=1, nstar=1, eps0=0.05, tmax=25)</span><span class="w">
</span></code></pre></div></div>

<iframe width="100%" height="500" src="https://rdrr.io/snippets/embed/?code=%23Paste%20code%20here" frameborder="0"></iframe>

<p>In the Taylor demo (below), we make this approximation visible by plotting the <em>true</em> mapping</p>

\[\epsilon(t+1)=f(n^*+\epsilon(t)) - n^*\]

<p>against the <em>linear</em> prediction</p>

\[\epsilon(t+1)=\lambda\,\epsilon(t),\]

<p>and showing that they agree only when \(\epsilon(t)\) is sufficiently small. That is the key conceptual point: <strong>\(\lambda\) is a local statement</strong>, and the Taylor approximation is exactly the step that makes that locality explicit.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">############################################################</span><span class="w">
</span><span class="c1">## Visualize the Taylor approximation directly  ##</span><span class="w">
</span><span class="c1">############################################################</span><span class="w">

</span><span class="c1"># Discrete-time logistic map (same form as your cobweb code)</span><span class="w">
</span><span class="n">f_logistic</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">N</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rd</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">N</span><span class="o">/</span><span class="n">K</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># One-step linearization near a steady state n*</span><span class="w">
</span><span class="c1"># epsilon(t+1) ≈ lambda * epsilon(t), where lambda = f'(n*)</span><span class="w">
</span><span class="n">lambda_logistic</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">nstar</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c1"># f'(N) = 1 + rd - 2*rd*N/K</span><span class="w">
  </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rd</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">2</span><span class="o">*</span><span class="n">rd</span><span class="o">*</span><span class="n">nstar</span><span class="o">/</span><span class="n">K</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># Identify fixed points for this model:</span><span class="w">
</span><span class="c1"># n* = 0 and n* = K (for rd &gt; 0)</span><span class="w">
</span><span class="n">fixed_points_logistic</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">)</span><span class="w">

</span><span class="n">taylor.visual</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">rd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.8</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">nstar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">eps_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.25</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">lam</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lambda_logistic</span><span class="p">(</span><span class="n">nstar</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">)</span><span class="w">
  
  </span><span class="c1"># Compare f(n* + eps) - n* to linear prediction lam*eps</span><span class="w">
  </span><span class="n">eps</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="o">-</span><span class="n">eps_range</span><span class="p">,</span><span class="w"> </span><span class="n">eps_range</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="o">=</span><span class="m">200</span><span class="p">)</span><span class="w">
  </span><span class="n">true_map</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">f_logistic</span><span class="p">(</span><span class="n">nstar</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eps</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nstar</span><span class="w">
  </span><span class="n">lin_map</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lam</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">eps</span><span class="w">
  
  </span><span class="n">ymax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">true_map</span><span class="p">,</span><span class="w"> </span><span class="n">lin_map</span><span class="p">)))</span><span class="w">
  </span><span class="n">plot</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span><span class="w"> </span><span class="n">true_map</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w">
       </span><span class="n">xlab</span><span class="o">=</span><span class="nf">expression</span><span class="p">(</span><span class="n">epsilon</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span><span class="w"> 
       </span><span class="n">ylab</span><span class="o">=</span><span class="nf">expression</span><span class="p">(</span><span class="n">epsilon</span><span class="p">(</span><span class="n">t</span><span class="m">+1</span><span class="p">)),</span><span class="w">
       </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="n">ymax</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="p">))</span><span class="w">
  </span><span class="n">lines</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span><span class="w"> </span><span class="n">lin_map</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
  </span><span class="n">abline</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
  </span><span class="n">legend</span><span class="p">(</span><span class="s2">"topleft"</span><span class="p">,</span><span class="w">
         </span><span class="n">legend</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">expression</span><span class="p">(</span><span class="s2">"True: "</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">epsilon</span><span class="p">(</span><span class="n">t</span><span class="m">+1</span><span class="p">)</span><span class="o">==</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="s2">"*"</span><span class="o">+</span><span class="n">epsilon</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">-</span><span class="n">n</span><span class="o">^</span><span class="s2">"*"</span><span class="p">),</span><span class="w">
                  </span><span class="nf">expression</span><span class="p">(</span><span class="s2">"Linear: "</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">epsilon</span><span class="p">(</span><span class="n">t</span><span class="m">+1</span><span class="p">)</span><span class="o">==</span><span class="n">lambda</span><span class="o">*</span><span class="n">epsilon</span><span class="p">(</span><span class="n">t</span><span class="p">))),</span><span class="w">
         </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">bty</span><span class="o">=</span><span class="s2">"n"</span><span class="p">)</span><span class="w">
  
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"\n--- Taylor visualization summary ---\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"n* ="</span><span class="p">,</span><span class="w"> </span><span class="n">nstar</span><span class="p">,</span><span class="w"> </span><span class="s2">"  rd ="</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="s2">"  K ="</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">)</span><span class="w">
  </span><span class="n">cat</span><span class="p">(</span><span class="s2">"lambda = f'(n*) ="</span><span class="p">,</span><span class="w"> </span><span class="n">lam</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n\n"</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># Example:</span><span class="w">
</span><span class="c1"># taylor.visual(rd=1.8, K=1, nstar=1, eps_range=0.25)</span><span class="w">
</span></code></pre></div></div>

<iframe width="100%" height="1000" src="https://rdrr.io/snippets/embed/?code=%23Paste%20code%20here" frameborder="0"></iframe>

    </div><!-- /.article-wrap -->
    
  </article>
</div><!-- /#index -->

<div class="footer-wrap">
  <footer>
    <div class="google-ads">
  <!-- 320 x 50 ad -->
  <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <ins class="adsbygoogle"
       style="display:inline-block;width:320px;height:50px"
       data-ad-client=""
       data-ad-slot=""></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div><!-- /.google-ads -->

<span>&copy; 2026 Justin D. Yeakel. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="//jdyeakel.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="//jdyeakel.github.io/assets/js/scripts.min.js"></script>


  
          

</body>
</html>
