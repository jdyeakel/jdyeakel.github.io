<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Demo 4 :: Predation &#8211; Yeakel Group</title>

<meta name="keywords" content="about, Jekyll, theme, responsive">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Demo 4 :: Predation">




<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="//jdyeakel.github.io/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Demo 4 :: Predation">

<meta property="og:url" content="//jdyeakel.github.io/teaching/ecology/summersections/demo_4_pred/">
<meta property="og:site_name" content="Yeakel Group">





<link rel="canonical" href="//jdyeakel.github.io/teaching/ecology/summersections/demo_4_pred/">
<link href="//jdyeakel.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Yeakel Group Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="//jdyeakel.github.io/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="//jdyeakel.github.io/assets/js/vendor/html5shiv.min.js"></script>
	<script src="//jdyeakel.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="//jdyeakel.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="//jdyeakel.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="//jdyeakel.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="//jdyeakel.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="//jdyeakel.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="//jdyeakel.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="//jdyeakel.github.io/images/apple-touch-icon-144x144-precomposed.png">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;600&display=swap" rel="stylesheet">

<!-- Mathjax Support -->
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>

<body class="page">

<script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="//jdyeakel.github.io">Yeakel Group</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
					    
					    <li><a href="//jdyeakel.github.io/people/" >People</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/diversity/" >Diversity</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/research/" >Research</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/teaching/" >Teaching</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/CV/" >Publications</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/posts/" >Artwork</a></li>
					  
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
	  


	<img src="//jdyeakel.github.io/images/ecology/elephants_small.jpg" class="bio-photo" alt="J. D. Yeakel bio photo"></a>

<h3>Fundamentals of Ecology</h3>
<p>"The Earth is what we all have in common"<br> -Wendell Barry</p>
<!-- <a href="mailto:jdyeakel@gmail.com" class="author-social" target="_blank"><i class="fa fa-envelope-square"></i> Email</a>





<a href="http://github.com/jdyeakel" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>






 -->

 </div>
  <article>
    <h1>Demo 4 :: Predation</h1>
    <div class="article-wrap">
      <p><a href="//jdyeakel.github.io/teaching/ecology">&lt; Back to Course Page</a><br />
<br /></p>

<h2 id="visualizing-predator-prey-isoclines-and-dynamics">Visualizing predator-prey isoclines and dynamics</h2>

<p>Below is a code block where the Lotka Volterra predatpr-prey system is simulated.
The main plot will show the predator \(P\) (red) and prey \(N\) (blue) isoclines, as well as the starting point and trajectory of the \(P\) and \(N\) populations over time (green circle and line, respectively). On the top right inset is a plot of the two \(P\) and \(N\) population sizes plotted over time. Make sure that you understand how the isoclines determine the flow and direct how the combined trajectories of \(P\) and \(N\) (green) change over time, and how this corresponds to the population sizes shown in the inset.</p>

<p>Try changing the values of the parameters. Based on your derived equations for the \(P\) and \(N\) isoclines, try to anticipate what the changes you make will do to the predator/prey dynamics. One interesting thing to do: what happens when you leave all of the parameters set, but change the starting conditions?</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">library</span><span class="p">(</span><span class="n">RColorBrewer</span><span class="p">)</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="n">deSolve</span><span class="p">)</span><span class="w">
    </span><span class="n">pal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">brewer.pal</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="s1">'Set1'</span><span class="p">)</span><span class="w">
    </span><span class="c1"># Define the Rates function</span><span class="w">
    </span><span class="n">pred.flow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">Pstart</span><span class="p">,</span><span class="n">Nstart</span><span class="p">,</span><span class="n">tmax</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="c1"># LV.comp = function(r1,r2,alpha,beta,K1,K2,N1start,N2start,tmax) {</span><span class="w">
        </span><span class="n">yini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pstart</span><span class="p">,</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nstart</span><span class="p">)</span><span class="w">
        
        </span><span class="n">fmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">parms</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">with</span><span class="p">(</span><span class="n">as.list</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">dP</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
            </span><span class="n">dN</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
            </span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">dP</span><span class="p">,</span><span class="n">dN</span><span class="p">))</span><span class="w">
        </span><span class="p">})</span><span class="w">
        </span><span class="p">}</span><span class="w">
        
        </span><span class="n">times</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="w"> 
        </span><span class="n">out</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ode</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yini</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmap</span><span class="p">,</span><span class="w"> </span><span class="n">parms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w">

        </span><span class="n">Ptraj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">out</span><span class="p">[,</span><span class="m">2</span><span class="p">];</span><span class="w">
        </span><span class="n">Ntraj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">out</span><span class="p">[,</span><span class="m">3</span><span class="p">];</span><span class="w">
        </span><span class="n">timeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">out</span><span class="p">[,</span><span class="m">1</span><span class="p">];</span><span class="w">

        </span><span class="n">Pend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tail</span><span class="p">(</span><span class="n">Ptraj</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
        </span><span class="n">Nend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tail</span><span class="p">(</span><span class="n">Ntraj</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">

        </span><span class="n">maxtraj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">Ptraj</span><span class="p">,</span><span class="n">Ntraj</span><span class="p">));</span><span class="w">

        </span><span class="n">Psize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxtraj</span><span class="o">*</span><span class="m">1.2</span><span class="p">;</span><span class="w">
        </span><span class="n">Nsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxtraj</span><span class="o">*</span><span class="m">1.2</span><span class="p">;</span><span class="w">

        </span><span class="n">p_isocline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1"># = N</span><span class="w">
        </span><span class="n">n_isocline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="o">/</span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="c1"># = P</span><span class="w">

        </span><span class="n">par</span><span class="p">(</span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">))</span><span class="w">
        </span><span class="n">plot</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="n">p_isocline</span><span class="p">,</span><span class="m">100</span><span class="p">),</span><span class="n">seq</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="n">Psize</span><span class="p">,</span><span class="n">length.out</span><span class="o">=</span><span class="m">100</span><span class="p">),</span><span class="n">type</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">maxtraj</span><span class="o">*</span><span class="m">1.2</span><span class="p">),</span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">maxtraj</span><span class="o">*</span><span class="m">1.2</span><span class="p">),</span><span class="n">xlab</span><span class="o">=</span><span class="s1">'N population'</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s1">'P population'</span><span class="p">,</span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">seq</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="n">Nsize</span><span class="p">,</span><span class="n">length.out</span><span class="o">=</span><span class="m">100</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="n">n_isocline</span><span class="p">,</span><span class="m">100</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
        </span><span class="n">points</span><span class="p">(</span><span class="n">Nstart</span><span class="p">,</span><span class="n">Pstart</span><span class="p">,</span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="n">cex</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">Ntraj</span><span class="p">,</span><span class="n">Ptraj</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">3</span><span class="p">],</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
        </span><span class="n">points</span><span class="p">(</span><span class="n">Nend</span><span class="p">,</span><span class="n">Pend</span><span class="p">,</span><span class="n">pch</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="n">cex</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="w">
        </span><span class="n">legend</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">maxtraj</span><span class="o">*</span><span class="m">1.2</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s1">'P isocline'</span><span class="p">,</span><span class="s1">'N isocline'</span><span class="p">),</span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">)</span><span class="w">

        </span><span class="n">par</span><span class="p">(</span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w">
        </span><span class="n">plot</span><span class="p">(</span><span class="n">timeline</span><span class="p">,</span><span class="n">Ptraj</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="n">xlab</span><span class="o">=</span><span class="s1">'Time'</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s1">'Pop. size'</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">maxtraj</span><span class="p">))</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">timeline</span><span class="p">,</span><span class="n">Ntraj</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,)</span><span class="w">

    </span><span class="p">}</span><span class="w">
    </span><span class="c1"># Plug in parameter values and run</span><span class="w">
    </span><span class="n">pred.flow</span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">Pstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">70</span><span class="p">,</span><span class="w"> </span><span class="n">Nstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<iframe width="100%" height="1000" src="https://rdrr.io/snippets/embed/?code=%23Paste%20code%20here" frameborder="0"></iframe>

<h2 id="visualizing-predator-prey-isoclines-and-dynamics-with-logistic-growth">Visualizing predator-prey isoclines and dynamics with logistic growth</h2>

<p>The previous predator-prey model assumes that the prey grows exponentially when the predator is either absent or at low densities. What if we assume instead that the prey demonstrates (more realistic) logistic growth under these conditions, where</p>

\[\begin{align}
\frac{\rm d}{\rm dt}P &amp;= baNP - mP \\ 
\frac{\rm d}{\rm dt}N &amp;= rN \left( 1-\frac{N}{K} \right) - aNP
\end{align}\]

<p>Try solving for the isoclines yourself, and confirm that you get functions that result in what is shown in the code block below. The orientation of the isoclines also suggest that flow is asymmetric from one isocline-derived quadrant to another. What is the effect of this asymmetry on the resulting dynamics? Explore similar parameter combinations as those aboveâ€¦ how are the dynamics similar and different?</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">library</span><span class="p">(</span><span class="n">RColorBrewer</span><span class="p">)</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="n">deSolve</span><span class="p">)</span><span class="w">
    </span><span class="n">pal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">brewer.pal</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="s1">'Set1'</span><span class="p">)</span><span class="w">
    </span><span class="c1"># Define the Rates function</span><span class="w">
    </span><span class="n">pred.flow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">Pstart</span><span class="p">,</span><span class="n">Nstart</span><span class="p">,</span><span class="n">tmax</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="c1"># LV.comp = function(r1,r2,alpha,beta,K1,K2,N1start,N2start,tmax) {</span><span class="w">
        </span><span class="n">yini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pstart</span><span class="p">,</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nstart</span><span class="p">)</span><span class="w">
        
        </span><span class="n">fmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">parms</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">with</span><span class="p">(</span><span class="n">as.list</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">dP</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
            </span><span class="n">dN</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="n">K</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
            </span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">dP</span><span class="p">,</span><span class="n">dN</span><span class="p">))</span><span class="w">
        </span><span class="p">})</span><span class="w">
        </span><span class="p">}</span><span class="w">
        
        </span><span class="n">times</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="w"> 
        </span><span class="n">out</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ode</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yini</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmap</span><span class="p">,</span><span class="w"> </span><span class="n">parms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w">

        </span><span class="n">Ptraj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">out</span><span class="p">[,</span><span class="m">2</span><span class="p">];</span><span class="w">
        </span><span class="n">Ntraj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">out</span><span class="p">[,</span><span class="m">3</span><span class="p">];</span><span class="w">
        </span><span class="n">timeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">out</span><span class="p">[,</span><span class="m">1</span><span class="p">];</span><span class="w">

        </span><span class="n">Pend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tail</span><span class="p">(</span><span class="n">Ptraj</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
        </span><span class="n">Nend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tail</span><span class="p">(</span><span class="n">Ntraj</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">

        </span><span class="n">maxtraj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">Ptraj</span><span class="p">,</span><span class="n">Ntraj</span><span class="p">));</span><span class="w">

        </span><span class="n">Psize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxtraj</span><span class="o">*</span><span class="m">1.2</span><span class="p">;</span><span class="w">
        </span><span class="n">Nsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxtraj</span><span class="o">*</span><span class="m">1.2</span><span class="p">;</span><span class="w">

        </span><span class="n">p_isocline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1"># = N</span><span class="w">
        </span><span class="n">n_isocline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="o">/</span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">K</span><span class="p">))</span><span class="o">*</span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="o">*</span><span class="n">K</span><span class="p">,</span><span class="n">length.out</span><span class="o">=</span><span class="m">100</span><span class="p">);</span><span class="w"> </span><span class="c1"># = P</span><span class="w">

        </span><span class="n">par</span><span class="p">(</span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">))</span><span class="w">
        </span><span class="n">plot</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="n">p_isocline</span><span class="p">,</span><span class="m">100</span><span class="p">),</span><span class="n">seq</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="n">Psize</span><span class="p">,</span><span class="n">length.out</span><span class="o">=</span><span class="m">100</span><span class="p">),</span><span class="n">type</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">maxtraj</span><span class="o">*</span><span class="m">1.2</span><span class="p">),</span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">maxtraj</span><span class="o">*</span><span class="m">1.2</span><span class="p">),</span><span class="n">xlab</span><span class="o">=</span><span class="s1">'N population'</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s1">'P population'</span><span class="p">,</span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="o">*</span><span class="n">K</span><span class="p">,</span><span class="n">length.out</span><span class="o">=</span><span class="m">100</span><span class="p">),</span><span class="n">n_isocline</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
        </span><span class="n">points</span><span class="p">(</span><span class="n">Nstart</span><span class="p">,</span><span class="n">Pstart</span><span class="p">,</span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="n">cex</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">Ntraj</span><span class="p">,</span><span class="n">Ptraj</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">3</span><span class="p">],</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
        </span><span class="n">points</span><span class="p">(</span><span class="n">Nend</span><span class="p">,</span><span class="n">Pend</span><span class="p">,</span><span class="n">pch</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="n">cex</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="w">
        </span><span class="n">legend</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">maxtraj</span><span class="o">*</span><span class="m">1.2</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s1">'P isocline'</span><span class="p">,</span><span class="s1">'N isocline'</span><span class="p">),</span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">)</span><span class="w">

        </span><span class="n">par</span><span class="p">(</span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w">
        </span><span class="n">plot</span><span class="p">(</span><span class="n">timeline</span><span class="p">,</span><span class="n">Ptraj</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="n">xlab</span><span class="o">=</span><span class="s1">'Time'</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s1">'Pop. size'</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">maxtraj</span><span class="p">))</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">timeline</span><span class="p">,</span><span class="n">Ntraj</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="n">pal</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,)</span><span class="w">

    </span><span class="p">}</span><span class="w">
    </span><span class="c1"># Plug in parameter values and run</span><span class="w">
    </span><span class="n">pred.flow</span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="n">Pstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">70</span><span class="p">,</span><span class="w"> </span><span class="n">Nstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<iframe width="100%" height="1000" src="https://rdrr.io/snippets/embed/?code=%23Paste%20code%20here" frameborder="0"></iframe>


    </div><!-- /.article-wrap -->
    
  </article>
</div><!-- /#index -->

<div class="footer-wrap">
  <footer>
    <div class="google-ads">
  <!-- 320 x 50 ad -->
  <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <ins class="adsbygoogle"
       style="display:inline-block;width:320px;height:50px"
       data-ad-client=""
       data-ad-slot=""></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div><!-- /.google-ads -->

<span>&copy; 2024 J. D. Yeakel. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="//jdyeakel.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="//jdyeakel.github.io/assets/js/scripts.min.js"></script>


  
          

</body>
</html>
