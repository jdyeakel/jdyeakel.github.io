<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Section 10 :: The Dynamics of Disease &#8211; Yeakel Group</title>

<meta name="keywords" content="about, Jekyll, theme, responsive">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Section 10 :: The Dynamics of Disease">




<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Section 10 :: The Dynamics of Disease">

<meta property="og:url" content="http://localhost:4000/teaching/ecology/sections2023/10_disease/">
<meta property="og:site_name" content="Yeakel Group">





<link rel="canonical" href="http://localhost:4000/teaching/ecology/sections2023/10_disease/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Yeakel Group Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;600&display=swap" rel="stylesheet">

<!-- Mathjax Support -->
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>

<body class="page">

<script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://localhost:4000">Yeakel Group</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
					    
					    <li><a href="http://localhost:4000/people/" >People</a></li>
					  
					    
					    <li><a href="http://localhost:4000/diversity/" >Diversity</a></li>
					  
					    
					    <li><a href="http://localhost:4000/research/" >Research</a></li>
					  
					    
					    <li><a href="http://localhost:4000/teaching/" >Teaching</a></li>
					  
					    
					    <li><a href="http://localhost:4000/CV/" >Publications</a></li>
					  
					    
					    <li><a href="http://localhost:4000/posts/" >Artwork</a></li>
					  
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
	  


	<img src="http://localhost:4000/images/ecology/elephants_small.jpg" class="bio-photo" alt="J. D. Yeakel bio photo"></a>

<h3>Fundamentals of Ecology</h3>
<p>"The Earth is what we all have in common"<br> -Wendell Barry</p>
<!-- <a href="mailto:jdyeakel@gmail.com" class="author-social" target="_blank"><i class="fa fa-envelope-square"></i> Email</a>





<a href="http://github.com/jdyeakel" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>






 -->

 </div>
  <article>
    <h1>Section 10 :: The Dynamics of Disease</h1>
    <div class="article-wrap">
      <p><a href="http://localhost:4000/teaching/ecology">&lt; Back to Course Page</a><br />
<br /></p>

<h2 id="a-compartmental-model-of-disease">A Compartmental Model of Disease</h2>

<p>In the past we have tracked how populations change over time in the face of competition or with respect to predator-prey interactions. In theory, there is no reason why we couldn’t do the same for a parasite that causes disease within a host. However, infectious diseases have population dynamics that occur both within a host as well as between hosts. In this sense, host individuals are habitat for the pathogen, and we generally want to track when such pathogens successfully spread across a population of hosts, and are less concerned about the population size of a pathogen <em>within</em> a given host individual.</p>

<p>We can track the spread of a disease-causing pathogen among host individuals of a host population with a compartmental model, where we categorize host individuals into different compartments based on their state. Here a <em>state</em> is defined by whether they have had, currently have, or have never been exposed to a particular disease-causing pathogen. As such, the compartments, or states, are defined</p>
<ul>
  <li>\(S\): The density of susceptible individuals (never been exposed to pathogen)</li>
  <li>\(I\): The density of infected individuals (currently exposed to pathogen)</li>
  <li>\(R\): The density of recovered individuals (previously exposed to pathogen with lifetime immunity)</li>
</ul>

<p>So susceptible individuals can become infected, infected individuals recover, and recovered individuals stay recovered. Thus we are interested in tracking the dynamics of individuals moving along: \(S\rightarrow I \rightarrow R\) over time. One important assumption that we will make for now is: <em>the dynamics of the pathogen spreading within the host population occurs on a faster timescale than the population dynamics of the host</em>. In other words, we will assume that there are no births and deaths of host individuals during the time-period that we track the spread of the pathogen, though we will relax this assumption later on. This means that we can make the following assumption</p>

\[\begin{equation}
S(t) + I(t) + R(t) = N
\end{equation}\]

<p>where \(N\) is a constant. So while \(S(t)\), \(I(t)\) and \((R(t)\) <em>do</em> change over time, we assume that the total population size \(N\) is fixed.</p>

<blockquote>
  <h3 id="discussion">Discussion</h3>
  <ol>
    <li>If \(N\) is fixed, this means that \(dN/dt = 0\). Because \(N = S(t) + I(t) + R(t)\), we have the relationship \(dN/dt = d(S + I + R)/dt = dS/dt + dI/dt + dR/dt\). Interpret what this means… Start with what \(dN/dt\) should be if \(N\) is constant over time. Consider the gains and losses of individuals from each compartment under the constraint of a fixed population size \(N\).</li>
    <li>Under the assumption of a fixed population size \(N\), do we need to track the dynamics of all three compartments?</li>
  </ol>
</blockquote>

<p>Now let’s consider the transition rates between the \(S\), \(I\), and \(R\) compartments. By transition rates, we mean the per-unit-time movement of individuals from one compartment to the other… so the rate at which susceptible individuals become infected, and the rate at which infected individuals recover. Let’s first consider the former, because it is a little more complicated. But we can start with a simple statement: the rate at which susceptible individuals become infected <em>is dependent on the number of infected individuals</em>… the more infected individuals there are, the faster the susceptible individuals will become infected. This captures the idea that infection spreads by contact between susceptible and infected individuals, and the more infected individuals there are, the more contact there is. We call this <em>the force of infection</em>, and because the force of infection changes with \(I\), we write it as \(\lambda(I)\). This means that the force of infection \(\lambda(I)\) is a function of the density of infected individuals \(I\).</p>

<p>Let’s think about the force of infection a little more carefully. As the density of infected individuals increases, so should the force of infection, and this will promote the infection of susceptible individuals (\(S \rightarrow I\)). For our purposes, we will define the force of infection as</p>

\[\begin{equation}
\lambda(I) = \beta \frac{I}{N}
\end{equation}\]

<p>where \(\beta\) is the transmission rate with units \(1/[time]\), and \(I/N\) is the proportion of the population that is infected.</p>

<p>If the rate that susceptible hosts are infected is \(\lambda(I)\), the rate at which they recover is given \(\gamma\). This rate of recovery has units of \(1/[time]\), and determines how quickly an infected individual moves to the recovered compartment. One way of understanding the recovery rate \(\gamma\) is that \(1/\gamma\) has units of \([time]\), and can be interpreted as the <em>average amount of time an individual is infected</em>. The full dynamics for the infected class is thus</p>

\[\begin{equation}
\frac{\rm d}{\rm dt}I = \lambda(I)S - \gamma I = \beta \frac{I}{N}S - \gamma I
\end{equation}\]

<p>Before we even think about the susceptible or recovered compartment, we can say something interesting about when an infectious pathogen might be expected to spread. An infectious pathogen is expected to spread when \(dI/dt &gt; 0\). Exploring this, we find</p>

\[\begin{align}
\frac{\rm d}{\rm dt}I &amp;&gt; \beta \frac{I}{N} - \gamma I \\ \\
0 &amp;&gt; \beta \frac{I}{N}S - \gamma I \\ \\
\beta \frac{I}{N}S &amp;&gt; \gamma I \\ \\
\beta \frac{S}{N} &amp;&gt; \gamma \\ \\
\frac{S}{N} &amp;&gt; \frac{\gamma}{\beta}
\end{align}\]

<p>Very similar to what your book provides in chapter 13, this represents a threshold density of susceptible individuals that is required for an infectious pathogen to spread, the only difference being that here the threshold is represented as a proportion of susceptible individuals in the population (in the book it is left unstated, however the population size \(N\) is normalized to 1, and this can easily lead to confusion - it is more clear to keep all of the terms unnormalized as we are doing here).</p>

<blockquote>
  <h3 id="discussion-1">Discussion</h3>
  <ol>
    <li>What values of \(\beta\) and \(\gamma\) would lead to infections that are more or less easily spread throughout a population?</li>
    <li>Can you think or different diseases that might be described by a higher or lower \(\gamma/\beta\)? Justify your reasoning.</li>
    <li>Consider the definitions of \(\beta\) and \(\gamma\). How would <em>social distancing</em> impact these parameters? Which of the two would it most likely affect and in what way?</li>
  </ol>
</blockquote>

<h2 id="the-basic-reproductive-number">The basic reproductive number</h2>

<p>Ultimately, we want to know - on average - how many hosts will be secondarily infected by an infected host. This can be determined by finding \(R_0\) (pronounced <em>R knot</em>), and is very similar to determining the threshold density of susceptible individuals needed for a pathogen to spread. The important distinction here is the \(R_0\) is defined relative to a host population <em>nearly entirely composed of susceptible individuals</em>. In other words, \(R_0\) must be determined at the beginning of the infection, where there \(S(t=0) = N-1\) and \(I(t=0) = 1\). To find \(R_0\) for the basic SIR model, we examine the condition for disease spread</p>

\[\begin{align}
\frac{\rm d}{\rm dt}I &amp;&gt; 0 \\ \\
\beta \frac{I}{N} S - \gamma I &amp;&gt; 0 \\ \\
\beta \frac{I}{N} S &amp;&gt; \gamma I \\ \\
\beta \frac{S}{N} &amp;&gt; \gamma \\ \\
\beta \frac{N-1}{N} &amp;&gt; \gamma \\ \\
\beta &amp;&gt; \gamma \\ \\
\frac{\beta}{\gamma} &amp;&gt; 1 \\ \\
R_0 = \frac{\beta}{\gamma} &amp;&gt; 1
\end{align}\]

<p>As we can see here, we must assume that \((N+1)/N\) approximates 1, and this is only true if the size of the population \(N\) is large. We also find that \(R_0 = \beta/\gamma\). When \(\beta/\gamma &gt; 1\) the disease will spread because each infected host will spread it to more than one susceptible host. When \(\beta/\gamma &lt; 1\), the disease will not spread because each infected host will spread the pathogen to less than one susceptible host (on average).</p>

<h2 id="the-full-sir-model">The full SIR model</h2>
<p>Now let’s consider the dynamics of infection as well as the dynamics of the susceptible and recovered compartments. Any flow of individuals entering the infected compartment <em>needs to leave the susceptible compartment</em>. So the outflow of susceptibles must match the inflow of infected! That gives us</p>

\[\begin{equation}
\frac{\rm d}{\rm dt}S = -\lambda(I)S = -\beta I S
\end{equation}\]

<p>Notice the role here of the (-) sign… it is important! Now, similarity, the inflow of individuals into the recovered compartment <em>must match the outflow of individuals from the infected compartment</em>. This means that</p>

\[\begin{equation}
\frac{\rm d}{\rm dt}R = \gamma I
\end{equation}\]

<p>Putting this all together, we have the full SIR model</p>

\[\begin{align}
\frac{\rm d}{\rm dt}S &amp;= -\beta \frac{I}{N} S \\ \\
\frac{\rm d}{\rm dt}I &amp;= \beta \frac{I}{N} S - \gamma I \\ \\
\frac{\rm d}{\rm dt}R &amp;= \gamma I \\ \\
\end{align}\]

<blockquote>
  <h3 id="discussion-2">Discussion</h3>
  <ol>
    <li>Prove that \(dS/dt + dI/dt + dR/dt = 0\) by substituting in the above equations</li>
    <li>What might you add to the above equations if lifelong immunity was not guaranteed?</li>
  </ol>
</blockquote>

<p>Now let’s examine a simulation of the above equations</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">library</span><span class="p">(</span><span class="n">deSolve</span><span class="p">)</span><span class="w">
    </span><span class="n">sir.basic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">S0</span><span class="p">,</span><span class="n">I0</span><span class="p">,</span><span class="n">R0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">yini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S0</span><span class="p">,</span><span class="n">I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I0</span><span class="p">,</span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R0</span><span class="p">)</span><span class="w">
        
        </span><span class="n">fmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">parms</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">with</span><span class="p">(</span><span class="n">as.list</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">dS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
            </span><span class="n">dI</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gamma</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w">
            </span><span class="n">dR</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gamma</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w">
            </span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">dS</span><span class="p">,</span><span class="n">dI</span><span class="p">,</span><span class="n">dR</span><span class="p">))</span><span class="w">
        </span><span class="p">})</span><span class="w">
        </span><span class="p">}</span><span class="w">
        
        </span><span class="n">times</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="w"> 
        </span><span class="n">out</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ode</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yini</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmap</span><span class="p">,</span><span class="w"> </span><span class="n">parms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w">
        
        </span><span class="n">plot</span><span class="p">(</span><span class="n">out</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="n">out</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s1">'Time'</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s1">'Compartment Size'</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">S0</span><span class="o">+</span><span class="n">I0</span><span class="o">+</span><span class="n">R0</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="s1">'green'</span><span class="p">)</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">out</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="n">out</span><span class="p">[,</span><span class="m">3</span><span class="p">],</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">out</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="n">out</span><span class="p">[,</span><span class="m">4</span><span class="p">],</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span><span class="w">
        </span><span class="n">legend</span><span class="p">(</span><span class="m">0.9</span><span class="o">*</span><span class="n">tmax</span><span class="p">,</span><span class="n">S0</span><span class="o">+</span><span class="n">I0</span><span class="o">+</span><span class="n">R0</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s1">'S'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'R'</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s1">'green'</span><span class="p">,</span><span class="s1">'red'</span><span class="p">,</span><span class="s1">'blue'</span><span class="p">),</span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">sir.basic</span><span class="p">(</span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="m">0.05</span><span class="p">,</span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="n">S0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">99</span><span class="p">,</span><span class="w"> </span><span class="n">I0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">R0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<iframe width="100%" height="800" src="https://rdrr.io/snippets/embed/?code=%23Paste%20code%20here" frameborder="0"></iframe>

<blockquote>
  <h3 id="discussion-3">Discussion</h3>
  <ol>
    <li>Given <code class="language-plaintext highlighter-rouge">beta = 0.1,gamma=0.05</code>, what is the outcome of the outbreak? Does everyone become infected? How is this relevance to <em>herd immunity</em>?</li>
    <li>Tune up the pathogen’s transmission rate… compared to a lower transmission rate, what do you notice about the steady state of the susceptible population over time?</li>
    <li>What combination of transmission rates and recovery rates leads to larger/short peak outbreaks vs. prolonged outbreaks?</li>
  </ol>
</blockquote>

<h2 id="the-sir-model-with-host-births-and-deaths">The SIR model with host births and deaths</h2>

<p>Now we will consider a Susceptible-Infected-Recovered model where we allow the host population to grow and decline. We will assume, in this case, that both reproduction and mortality of the hosts are <em>independent</em> of the pathogen. Let us assume that the hosts birth rate is given by \(b\) and its mortality rate is given by \(\mu\). We will also assume: a) that all offsprings are initially susceptible, and b) the mortality of susceptible, infected, and recovered individuals is the same. These assumptions give us the demographic SIR model</p>

\[\begin{align}
\frac{\rm d}{\rm dt}S &amp;= bN - \mu S -\beta \frac{I}{N} S \\ \\
\frac{\rm d}{\rm dt}I &amp;= \beta \frac{I}{N} S - (\gamma + \mu) I \\ \\
\frac{\rm d}{\rm dt}R &amp;= \gamma I - \mu R \\ \\
\end{align}\]

<blockquote>
  <h3 id="discussion-4">Discussion</h3>
  <ol>
    <li>Why is \(b\) included only in the \(dS/dt\) equation, whereas \(\mu\) is included in all \(dS/dt\), \(dI/dt\), and \(dR/dt\) equations?</li>
    <li>For \(dS/dt\), why is birth given by \(b N\) whereas death is given by \(\mu S\)?</li>
    <li>Is \(N\) constant in the the demographic SIR model?</li>
    <li>Does \(dS/dt + dI/dt + dR/dt = 0\) in the demographic SIR model?</li>
    <li>From the equation for \(dS/dt\), solve for the steady state of \(I^*\). From the equation for \(dI/dt\), solve for the steady state of \(S^*\), From the equation for \(dR/dt\), solve for the steady state of \(R^*\). What does this tell us about the ability of a pathogen to persist in the population?</li>
  </ol>
</blockquote>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">library</span><span class="p">(</span><span class="n">deSolve</span><span class="p">)</span><span class="w">
    </span><span class="n">sir.demo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">S0</span><span class="p">,</span><span class="n">I0</span><span class="p">,</span><span class="n">R0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">yini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S0</span><span class="p">,</span><span class="n">I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I0</span><span class="p">,</span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R0</span><span class="p">)</span><span class="w">
        
        </span><span class="n">fmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">parms</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">with</span><span class="p">(</span><span class="n">as.list</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">dS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
            </span><span class="n">dI</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">gamma</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w">
            </span><span class="n">dR</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gamma</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w">
            </span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">dS</span><span class="p">,</span><span class="n">dI</span><span class="p">,</span><span class="n">dR</span><span class="p">))</span><span class="w">
        </span><span class="p">})</span><span class="w">
        </span><span class="p">}</span><span class="w">
        
        </span><span class="n">times</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="w"> 
        </span><span class="n">out</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ode</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yini</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmap</span><span class="p">,</span><span class="w"> </span><span class="n">parms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w">
        
        
        </span><span class="n">nt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">out</span><span class="p">[,</span><span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="m">1</span><span class="p">,</span><span class="n">sum</span><span class="p">)</span><span class="w">
        </span><span class="n">maxvalue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">out</span><span class="p">[,</span><span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="o">/</span><span class="n">nt</span><span class="p">)</span><span class="w">
        </span><span class="n">nstar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nt</span><span class="p">[</span><span class="n">tmax</span><span class="p">]</span><span class="w">

        </span><span class="n">Ssol</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">gamma</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span><span class="w">
        </span><span class="n">Isol</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">gamma</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mu</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu</span><span class="o">/</span><span class="n">beta</span><span class="w">
        </span><span class="n">Rsol</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">gamma</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">gamma</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mu</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu</span><span class="o">/</span><span class="n">beta</span><span class="p">)</span><span class="w">

        </span><span class="n">plot</span><span class="p">(</span><span class="n">out</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="n">out</span><span class="p">[,</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="n">nt</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s1">'Time'</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s1">'Proportional Compartment Size'</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">maxvalue</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="s1">'green'</span><span class="p">)</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">out</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="n">out</span><span class="p">[,</span><span class="m">3</span><span class="p">]</span><span class="o">/</span><span class="n">nt</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span><span class="w">
        </span><span class="n">lines</span><span class="p">(</span><span class="n">out</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="n">out</span><span class="p">[,</span><span class="m">4</span><span class="p">]</span><span class="o">/</span><span class="n">nt</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span><span class="w">
        </span><span class="n">legend</span><span class="p">(</span><span class="m">0.9</span><span class="o">*</span><span class="n">tmax</span><span class="p">,</span><span class="n">maxvalue</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s1">'S'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'R'</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s1">'green'</span><span class="p">,</span><span class="s1">'red'</span><span class="p">,</span><span class="s1">'blue'</span><span class="p">),</span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w">
        </span><span class="c1"># lines(seq(1,tmax,length.out=10),rep(Ssol,10),lty=2)</span><span class="w">
        </span><span class="c1"># lines(seq(1,tmax,length.out=10),rep(Isol,10),lty=2)</span><span class="w">
        </span><span class="c1"># lines(seq(1,tmax,length.out=10),rep(Rsol,10).lty=2)</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">sir.demo</span><span class="p">(</span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="m">0.1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="m">0.02</span><span class="p">,</span><span class="n">mu</span><span class="o">=</span><span class="m">0.02</span><span class="p">,</span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="n">S0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">99</span><span class="p">,</span><span class="w"> </span><span class="n">I0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">R0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<iframe width="100%" height="700" src="https://rdrr.io/snippets/embed/?code=%23Paste%20code%20here" frameborder="0"></iframe>

<blockquote>
  <h3 id="discussion-5">Discussion</h3>
  <ol>
    <li>Note that here we are plotting the proportional size of the \(S\), \(I\), and \(R\) compartment! What dynamics do you observe for \(S(t)/N(t)\), \(I(t)/N(t)\), and \(R(t)/N(t)\)?</li>
    <li>The trajectory for \(I(t)/N(t)\) does not go to zero over time. What do this mean?</li>
    <li>Solve for \(R_0\) for the SIR model with demographic processes.</li>
    <li>Confirm the following steady state solutions (shown below) by solving for \(dS/dt=0\), \(dI/dt=0\), and \(dR/dt=0\)</li>
    <li>Confirm your analytical steady state solutions match the simulation given different parameter values</li>
  </ol>
</blockquote>

<p>Steady state solutions for the demographic SIR model</p>

\[\begin{align}
\frac{S^*}{N^*} &amp;= \frac{\gamma + \mu}{\beta} \\ \\
\frac{I^*}{N^*} &amp;= \frac{b}{\gamma+\mu} - \frac{\mu}{\beta} \\ \\
\frac{R^*}{N^*} &amp;= \frac{\gamma}{\mu}\left(\frac{b}{\gamma+\mu}-\frac{\mu}{\beta}\right)
\end{align}\]


    </div><!-- /.article-wrap -->
    
  </article>
</div><!-- /#index -->

<div class="footer-wrap">
  <footer>
    <div class="google-ads">
  <!-- 320 x 50 ad -->
  <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <ins class="adsbygoogle"
       style="display:inline-block;width:320px;height:50px"
       data-ad-client=""
       data-ad-slot=""></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div><!-- /.google-ads -->

<span>&copy; 2024 J. D. Yeakel. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>


  
          

</body>
</html>
