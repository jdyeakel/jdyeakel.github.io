<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Section 4 :: Evolution by natural selection &#8211; Yeakel Group</title>

<meta name="keywords" content="about, Jekyll, theme, responsive">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Section 4 :: Evolution by natural selection">




<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="//jdyeakel.github.io/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Section 4 :: Evolution by natural selection">

<meta property="og:url" content="//jdyeakel.github.io/teaching/ecology/section4/">
<meta property="og:site_name" content="Yeakel Group">





<link rel="canonical" href="//jdyeakel.github.io/teaching/ecology/section4/">
<link href="//jdyeakel.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Yeakel Group Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="//jdyeakel.github.io/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="//jdyeakel.github.io/assets/js/vendor/html5shiv.min.js"></script>
	<script src="//jdyeakel.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="//jdyeakel.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="//jdyeakel.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="//jdyeakel.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="//jdyeakel.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="//jdyeakel.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="//jdyeakel.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="//jdyeakel.github.io/images/apple-touch-icon-144x144-precomposed.png">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;600&display=swap" rel="stylesheet">

<!-- Mathjax Support -->
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>

<body class="page">

<script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="//jdyeakel.github.io">Yeakel Group</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
					    
					    <li><a href="//jdyeakel.github.io/people/" >People</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/diversity/" >Diversity</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/research/" >Research</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/teaching/" >Teaching</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/CV/" >Publications</a></li>
					  
					    
					    <li><a href="//jdyeakel.github.io/posts/" >Posts</a></li>
					  
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
	  


	<img src="//jdyeakel.github.io/images/ecology/elephants_small.jpg" class="bio-photo" alt="Justin D. Yeakel bio photo"></a>

<h3>Fundamentals of Ecology</h3>
<p>"The Earth is what we all have in common"<br> -Wendell Barry</p>
<!-- <a href="mailto:jdyeakel@gmail.com" class="author-social" target="_blank"><i class="fa fa-envelope-square"></i> Email</a>





<a href="http://github.com/jdyeakel" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>






 -->

 </div>
  <article>
    <h1>Section 4 :: Evolution by natural selection</h1>
    <div class="article-wrap">
      <p><a href="//jdyeakel.github.io/teaching/ecology">&lt; Back to Course Page</a><br />
<br /></p>

<p>Natural selection is the process by which different traits exhibited by individuals within a population are selected <em>for</em> or <em>against</em> over time. Traits that benefit the individual’s fitness are selected for, and traits that reduce the individual’s fitness are selected against. <strong><em>Fitness is defined by an individual’s ability to survive and reproduce.</em></strong> Individuals with traits that either benefit its ability to survive or produce viable offspring have greater fitness compared to those with lesser abilities within a given environment. Over generational timescales, it is the individuals with these <em>fitness-maximizing</em> traits that become more plentiful in the population. Evolution is defined by the change in trait distributions over this generational time-span. Importantly, natural selection is something that occurs at the <em>individual-level</em>; because evolution is defined with respect to changing trait distributions, it is something that occurs at the <em>population-level</em>.</p>

<blockquote>
  <h3 id="evolution-of-a-particular-trait-within-a-population-requires">Evolution of a particular trait within a population requires</h3>
  <ol>
    <li>Heritability (the trait is passed from parents to offspring)</li>
    <li>Variability in the population (different individuals have different trait values)</li>
    <li>That different trait values are linked to fitness differences</li>
  </ol>
</blockquote>

<p>A <em>trait</em> can be any measurable characteristic of an individual… from anatomical or physiological characteristics such as body size or femur:tibia length ratios to the frequency of a particular behavior such as a mating vocalization. If the trait fulfills the above conditions, it is subject to selection and can evolve over time.</p>

<h2 id="trait-distributions">Trait Distributions</h2>

<p>If the trait is measured as a continuous variable (say height, length, or mass), it is often normally distributed within a population. That is, the frequencies of different trait values among individuals in the population follows a normal (or Gaussian) distribution. These types of distributions can be described by two statistics: the mean and the standard deviation.</p>

<figure>
<img src="//jdyeakel.github.io/images/ecology/dist.jpg" width="700" />
<figcaption> Frequency distribution of traits among indidviduals in a population. The **mean** is a statistic that describes the *central tendancy* of the distribution. The **standard deviation** is a statistic that describes the amount of variability of traits about the mean. Recall that it is this variability that fuels the selective process. Without variability there is nothing to select from.
</figcaption>
</figure>

<p>Let’s look at one of the most famous examples of natural selection that we have observed in the wild, which was documented within a population of finches on a small island in the Galapagos Archipelago.</p>

<figure>
<img src="//jdyeakel.github.io/images/ecology/galapagos.jpg" width="700" />
<figcaption> The Galapagos islands, off the coast of Equador.
</figcaption>
</figure>

<figure>
<img src="//jdyeakel.github.io/images/ecology/daphne.jpg" width="700" />
<figcaption> Daphne Major is a barren and nearly treeless landscape.
</figcaption>
</figure>

<blockquote>
  <p><strong><em>In the 1970s-80s, biologists Peter and Rosemary Grant caught and measured birds from more than 20 generations of finches on the Galapagos island of Daphne Major. In one of those years, 1977, a severe drought caused vegetation to wither, and the only remaining food source were large, tough, drought-resistant seeds, which the finches ordinarily ignored. Were the birds with larger and stronger beaks for opening these tough seeds more likely to survive that year, and did they tend to pass this characteristic to their offspring? The data are beak depths (height of the beak at its base) of 751 finches caught the year before the drought (1976) and 89 finches captured the year after the drought (1978). -Statistical Sleuth (3rd edition)</em></strong></p>
</blockquote>

<p>Let’s now look at the beak width data collected by Rosemary and Peter Grant on the 1976 and 1978 expedition. We will plot the frequencies of beak depth across individuals in population measured during 1976 and 1978. We will use the <code class="language-plaintext highlighter-rouge">hist()</code> function in <code class="language-plaintext highlighter-rouge">R</code>, which plots the frequency distribution. Because the number of individuals sampled in 1976 is very different (751 individuals in 1976 and 89 individuals in 1978), we have scaled the y-axis so that we are looking at the <em>proportion</em> of individuals with different trait values (this means the y-axis will range from \(0 \leftrightarrow 1\)).</p>

<figure>
<img src="//jdyeakel.github.io/images/ecology/beakdepth.jpg" width="700" />
<figcaption> Galapagos finch beak measurements from the Peter &amp; Rosemary Grant expedition.
</figcaption>
</figure>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="c1"># We first import the Peter and Rosemary Grant data set</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="n">Sleuth3</span><span class="p">)</span><span class="w">

    </span><span class="c1"># Define the years as a vector</span><span class="w">
    </span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex0218</span><span class="o">$</span><span class="n">Year</span><span class="w">
    </span><span class="c1"># Define the depth measures as a vector</span><span class="w">
    </span><span class="n">depth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex0218</span><span class="o">$</span><span class="n">Depth</span><span class="w">

    </span><span class="c1"># Select those measures taken in 1976</span><span class="w">
    </span><span class="n">depth_1976</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">depth</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="n">year</span><span class="o">==</span><span class="m">1976</span><span class="p">)]</span><span class="w">

    </span><span class="c1"># Select those measures taken in 1978</span><span class="w">
    </span><span class="n">depth_1978</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">depth</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="n">year</span><span class="o">==</span><span class="m">1978</span><span class="p">)]</span><span class="w">

    </span><span class="c1"># Histogram of 1976 measures (Black)</span><span class="w">
    </span><span class="n">hist</span><span class="p">(</span><span class="n">depth_1976</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">15</span><span class="p">),</span><span class="n">probability</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="n">breaks</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s1">'Beak depth'</span><span class="p">,</span><span class="n">main</span><span class="o">=</span><span class="s1">'Beak depth 1976-1978'</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s1">'Proportion of individuals sampled'</span><span class="p">)</span><span class="w">

    </span><span class="c1"># Add on top histogram of 1978 measures (Gray)</span><span class="w">
    </span><span class="n">hist</span><span class="p">(</span><span class="n">depth_1978</span><span class="p">,</span><span class="n">add</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="n">probability</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">,</span><span class="n">breaks</span><span class="o">=</span><span class="m">20</span><span class="p">)</span><span class="w">

    </span><span class="c1"># Legend to remind us which years the colors represent</span><span class="w">
    </span><span class="n">legend</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="m">0.8</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="s1">'1976'</span><span class="p">,</span><span class="s1">'1978'</span><span class="p">),</span><span class="n">pch</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s1">'black'</span><span class="p">,</span><span class="s1">'gray'</span><span class="p">))</span><span class="w">

</span></code></pre></div></div>

<iframe width="100%" height="500" src="https://rdrr.io/snippets/embed/?code=%23Paste%20code%20here" frameborder="0"></iframe>

<blockquote>
  <h3 id="discussion">Discussion</h3>
  <ol>
    <li>Use the <code class="language-plaintext highlighter-rouge">mean()</code> and <code class="language-plaintext highlighter-rouge">sd()</code> functions to calculate the mean and standard deviation of depth measurements from 1976 (<code class="language-plaintext highlighter-rouge">depth_1976</code>) and 1978 (<code class="language-plaintext highlighter-rouge">depth_1978</code>). How does the mean and standard deviation change over time?</li>
    <li>Try to explain <em>both</em> changes to the mean and stand deviation of the population.</li>
    <li>As mentioned above, there is a large difference in the number of individuals sampled from 1976 to 1978. Why? Can we say something about the traits of the individuals who <em>weren’t</em> sampled in 1978? In other words, which finches were selected against and why?</li>
    <li>Was this selection event caused directly or indirectly by the drought?</li>
  </ol>
</blockquote>

<h2 id="a-model-of-evolution-by-natural-selection">A Model of Evolution by Natural Selection</h2>

<p>Recall from above that evolution is defined by the change in trait frequencies over time. In the simplest framework, this would mean that the <em>mean</em> of the trait distribution for the population changes over time. In this next exercise, we will examine directly how the ingredients for natural selection that are listed above are absolutely vital for evolution to take place.</p>

<p>Nature is complicated, and our goal now is to understand how these very particular ingredients for evolution by natural selection affect evolutionary dynamics. In order to explore these ideas, we need to strip away the complexity of the natural world to something very simple, which we call a <em>model</em>. We should think of this model as a <em>toy</em> representation of the natural world. We give this model characteristics that we hope are somewhat realistic and important to the problem that we are aiming to investigate, but without the complexities of reality to confuse our results.</p>

<p>So this is <em>not</em> a computer science class, and it isn’t important if you understand the details of the code below, but it <em>is</em> important that you understand what we call <strong><em>pseudocode</em></strong>. Pseudocode is what we call the collection of rules implemented by a block of code, which are generally described in the line-by-line comments.</p>

<blockquote>
  <p><strong><em>The Pseudocode: Here is what the simulation does</em></strong>:</p>
  <ol>
    <li>We imagine a population that starts with \(N_0 = 100\) individuals, each of which are given a trait value.</li>
    <li>At the beginning we will randomly choose the trait value \(x\) from a normal distribution with an arbitrary mean of 0.5 and an initial standard deviation <code class="language-plaintext highlighter-rouge">sd0</code> that we input.</li>
    <li>At <strong>each time-step</strong>, 2 things happen:
      <ol>
        <li>Each individual gives birth to some number of offspring. <strong><em>Individuals with higher trait values (values of \(x\)) have a slight reproductive advantage and give birth to more offspring.</em></strong> The offspring produced by an adult with a trait value \(x = m\) will have a similar trait value… we will draw the offspring’s trait from a normal distribution with a mean \(m\) and standard deviation that we call the <code class="language-plaintext highlighter-rouge">mutation</code> value. This describes how different the offspring is likely to be from the parent… the larger the <code class="language-plaintext highlighter-rouge">mutation</code> value, the more likely the offspring’s trait value will be different from the parent’s at \(x = m\). Because we are drawing the offspring’s trait from a normal distribution around \(x = m\), the offspring has an equal change of having a trait value lower than \(m\) as having a trait value higher than \(m\).</li>
        <li>Each individual has a probability of dying, regardless of its trait value.</li>
      </ol>
    </li>
    <li>We encode these rules in the code below, and keep track of the <strong><em>mean trait value of the population</em></strong> over time. Sometimes too many individuals die and the simulation stops. In the plot this is shown as the mean trait value going to zero, which just means the population is now extinct.</li>
    <li>Because there are so many random things that might happen in a single simulation of a population, we want to run the simulation many times. Each repetition is independent of the others. We will plot the mean trait values of <code class="language-plaintext highlighter-rouge">reps = 100</code> independently run simulations.</li>
  </ol>
</blockquote>

<p>Now: read through the comments in the below code block, but don’t worry about the actual code itself (unless you dig that sort of thing). Copy the code block without editing anything, paste it into the R web-tool, and I’ll see you at the bottom.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="n">evolution.sim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">reps</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">N0</span><span class="p">,</span><span class="n">sd0</span><span class="p">,</span><span class="n">mutation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">reps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="c1"># Population begins at N0 individuals</span><span class="w">
            </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N0</span><span class="w">
            </span><span class="c1"># Draw random trait values for individuals from normal distribution</span><span class="w">
            </span><span class="c1"># With mean of 0.5 and standard deviation given by parameter sd0</span><span class="w">
            </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="n">sd0</span><span class="p">)</span><span class="w">
            </span><span class="c1"># Initialize vectors to save population and trait values</span><span class="w">
            </span><span class="n">popsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numeric</span><span class="p">(</span><span class="n">tmax</span><span class="p">)</span><span class="w">
            </span><span class="n">meantrait</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numeric</span><span class="p">(</span><span class="n">tmax</span><span class="p">)</span><span class="w">
            </span><span class="n">tic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w">
            </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w">
        
            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">t</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">tmax</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">tic</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="c1"># Advance time by 1</span><span class="w">
                </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="w">
                </span><span class="c1"># Reproduction</span><span class="w">
                </span><span class="c1"># Roll a weighted dice</span><span class="w">
                </span><span class="c1"># larger values of trait x produce more offspring</span><span class="w">
                </span><span class="n">offspring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">rnorm</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="o">*</span><span class="m">2</span><span class="p">,</span><span class="m">0.01</span><span class="p">),</span><span class="m">0</span><span class="p">)</span><span class="w">
                
                </span><span class="c1"># Assume that offspring have same trait as parents +/- some mutation</span><span class="w">
                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">offspring</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">offspring</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="n">newx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">offspring</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mutation</span><span class="p">)</span><span class="w">
                        </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">newx</span><span class="p">)</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">

                </span><span class="c1"># Mortality</span><span class="w">
                </span><span class="c1"># Roll an unweighted dice</span><span class="w">
                </span><span class="c1"># All individuals have the same chance of dying</span><span class="w">
                </span><span class="c1"># The chance of dying increases with population size</span><span class="w">
                </span><span class="n">prob_mort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="m">0.6</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">N0</span><span class="w">
                </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">prob_mort</span><span class="p">)</span><span class="w">

                </span><span class="c1"># Remove dead individual traits</span><span class="w">
                </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="n">d</span><span class="p">]</span><span class="w">

                </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
                </span><span class="c1"># Save this value to a vector</span><span class="w">
                </span><span class="n">popsize</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="w">
                </span><span class="c1"># Save population mean trait value to vector</span><span class="w">
                </span><span class="n">meantrait</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
                
                </span><span class="c1"># If population is extinct, stop</span><span class="w">
                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="n">tic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
            </span><span class="c1"># Plot the results</span><span class="w">
            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="n">plot</span><span class="p">(</span><span class="n">meantrait</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'l'</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="n">col</span><span class="o">=</span><span class="s1">'#00000050'</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s1">'Time'</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s1">'Mean trait value of population'</span><span class="p">)</span><span class="w">
            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="n">lines</span><span class="p">(</span><span class="n">meantrait</span><span class="p">,</span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s1">'#00000050'</span><span class="p">)</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="c1"># PARAMETERS</span><span class="w">
    </span><span class="c1"># reps = number of repetitions</span><span class="w">
    </span><span class="c1"># tmax = number of timesteps (keep this at 20)</span><span class="w">
    </span><span class="c1"># N0 = population size at beginning (keep this at 100)</span><span class="w">
    </span><span class="c1"># sd0 = trait standard deviation at beginning</span><span class="w">
    </span><span class="c1"># mutation = trait standard deviation of offspring</span><span class="w">

    </span><span class="c1"># RUN EVOLUTION SIMULATION</span><span class="w">
    </span><span class="n">evolution.sim</span><span class="p">(</span><span class="n">reps</span><span class="o">=</span><span class="m">100</span><span class="p">,</span><span class="n">tmax</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="n">N0</span><span class="o">=</span><span class="m">100</span><span class="p">,</span><span class="n">sd0</span><span class="o">=</span><span class="m">0.01</span><span class="p">,</span><span class="n">mutation</span><span class="o">=</span><span class="m">0.01</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<iframe width="100%" height="500" src="https://rdrr.io/snippets/embed/?code=%23Paste%20code%20here" frameborder="0"></iframe>

<p>Now that you’ve run the code, without changing any of the parameter presets, what you observe should look pretty boring. <strong><em>What are you looking at?</em></strong> You are looking at the output of the simulation described above, where we are following the traits of individuals over many generations within a population. <strong><em>Each line represents the mean trait value of the population over time.</em></strong> Because there are random, or stochastic, processes in the simulation, we are running the simulation 100 times, which accounts for the 100 lines that you observe. Any population line that jumps to <em>zero</em> means that that particular population has gone extinct.</p>

<blockquote>
  <h3 id="discussion-1">Discussion</h3>
  <ol>
    <li>What is realistic and what is unrealistic about the model setup?</li>
    <li>Describe the output of the simulation results</li>
    <li>I mention above that the simulation results look boring, and I mean this in the sense that the mean trait value of the population does not change much over time. In other words, there is not really <em>evolution</em> here. Why? Pay particular attention to the <code class="language-plaintext highlighter-rouge">sd0</code> and <code class="language-plaintext highlighter-rouge">mutation</code> values.</li>
  </ol>
</blockquote>

<h3 id="the-effect-of-variation">The effect of variation</h3>
<p>As implied above, there is not really evolution because we have not supplied the populations variability. Variability in this model comes in two forms: a) the trait variability that we initiate the population with, and b) the variability of offspring away from the parent’s trait values. In both cases, the variability provided is very low. Oh hey… I seem to recall <em>variation in traits</em> being one of the 3 ingredients for evolution by natural selection to operate! Coincidence? Unlikely.</p>

<p>Let’s explore how increasing trait variability influences the evolutionary process. <strong><em>Remember</em></strong> we have incorporated the assumption that <em>higher values of the trait \(x\) provides a slight reproductive advantage</em>. In other words, individuals with larger \(x\) values have slightly more offspring than individuals with low values of \(x\).</p>

<p><strong>Initial trait variability</strong>: Let’s first increase slightly the amount of variability that individuals start with at the beginning of the simulation. Try the following permutations on the original implementation of the code by replacing the last line with:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">evolution.sim(reps=100,tmax=20,N0=100,sd0=0.05,mutation=0.01)</code></li>
  <li><code class="language-plaintext highlighter-rouge">evolution.sim(reps=100,tmax=20,N0=100,sd0=0.1,mutation=0.01)</code></li>
</ul>

<blockquote>
  <h3 id="discussion-2">Discussion</h3>
  <ol>
    <li>What does the value of <code class="language-plaintext highlighter-rouge">sd0</code> specify?</li>
    <li>Describe what you observe as you increase <code class="language-plaintext highlighter-rouge">sd0</code>.</li>
    <li>What do you think is the cause of this effect?</li>
  </ol>
</blockquote>

<p><strong>Variability of offspring from parent trait values</strong>: Now that we’ve experimented with <code class="language-plaintext highlighter-rouge">sd0</code>, let’s now consider the variability of the offspring away from the parent, which is encoded in the parameter <code class="language-plaintext highlighter-rouge">mutation</code>. If <code class="language-plaintext highlighter-rouge">mutation=0</code>, then the offspring has <em>exactly</em> the same trait as its parent. So let’s examine this first. With the previous results in mind, where <code class="language-plaintext highlighter-rouge">sd0=0.1</code> and the results that you examined, let’s drop <code class="language-plaintext highlighter-rouge">mutation=0</code>, such that you plug in:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">evolution.sim(reps=100,tmax=20,N0=100,sd0=0.1,mutation=0)</code></li>
</ul>

<blockquote>
  <h3 id="discussion-3">Discussion</h3>
  <ol>
    <li>Compare these results to the case where <code class="language-plaintext highlighter-rouge">sd0=0.1</code> and <code class="language-plaintext highlighter-rouge">mutation=0.01</code>. Are they different?</li>
    <li>The big question… if there <em>is no mutation</em>, meaning every offspring is <em>exactly the same as their parent</em>, how do you explain these results???</li>
  </ol>
</blockquote>

<p>Now let’s set the initial variability to the lower value of <code class="language-plaintext highlighter-rouge">sd0=0.01</code> and explore just the impact of increasing <code class="language-plaintext highlighter-rouge">mutation</code>:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">evolution.sim(reps=100,tmax=20,N0=100,sd0=0.01,mutation=0.05)</code></li>
  <li><code class="language-plaintext highlighter-rouge">evolution.sim(reps=100,tmax=20,N0=100,sd0=0.01,mutation=0.1)</code></li>
</ul>

<blockquote>
  <h3 id="discussion-4">Discussion</h3>
  <ol>
    <li>Describe what you see</li>
    <li>Which of the two had a larger impact on evolution? Increasing <code class="language-plaintext highlighter-rouge">sd0</code> or increasing <code class="language-plaintext highlighter-rouge">mutation</code>?</li>
    <li>Which of the two had a larger impact on the <em>speed</em> of evolution? In other words, the time at which some amount of change is observed?</li>
    <li>What do you think the <em>cause</em> of these differences is?</li>
  </ol>
</blockquote>

<h3 id="models-tell-us-what-questions-to-ask">Models tell us what questions to ask</h3>
<p>You’ve now examined field data showcasing a selective event that resulted in evolution of a population within a very short period of time, as well as a simple model of evolution. Consider how exploration of the model, and the assumptions built into it might change our perspective when going out and studying populations in the wild. The model is useful because it is very simple in terms of the rules that we’ve injected into it, and the results that it produces may lead us to examine nature in different ways. The model <em>is not</em> designed to replicate nature… it is meant to capture a hypothesis of how a very few set of rules may influence how nature works. It shows us where to look. By building our assumptions into a model and understanding its output, we can go back to the island of Daphne Major and investigate whether nature actually works the way the model predicts. If we find that it does not, we have left something important out of the model, and we need to go back to the drawing board. If we find that nature works similar to model predictions, that is evidence that the relationships we have encoded into the model capture an important natural mechanism! We pat ourselves on the back and enjoy a cold beverage.</p>

<blockquote>
  <h3 id="discussion-5">Discussion</h3>
  <ol>
    <li>What does the model suggest is important for evolution by natural selection?</li>
    <li>Relate these concepts to what is observed on Daphne Major. What might you measure and investigate if you could go back to the island, now that you have model predictions to guide your thinking?</li>
    <li><span style="color:#ff0000;">Challenge Round</span> This model is very tweakable, though tweaking it will often break it (that is okay - you can’t make an omelette without breaking some eggs). How would we introduce an influence of trait \(x\) on mortality? Currently all individuals have equal probability of dying, and this probability increases as the population grows. Alter the <strong>Pseudocode</strong> above to incorporate some effect of trait \(x\) on mortality. If you are feeling daring, feel free to try to alter the code to implement your idea.</li>
    <li><span style="color:#ff0000;">Insanity Round</span> As we have explored, a reproductive advantage leads to directional selection towards higher mean trait values of \(x\). Building upon the Challenge Round idea, what if the trait-dependent mortality was <em>disruptive</em>? What would that mean and how would it be implemented? What would be the effect of a) directional selection via a reproductive advantage to higher values of trait \(x\) coupled with b) disruptive selection via trait-dependent mortality?</li>
  </ol>
</blockquote>

    </div><!-- /.article-wrap -->
    
  </article>
</div><!-- /#index -->

<div class="footer-wrap">
  <footer>
    <div class="google-ads">
  <!-- 320 x 50 ad -->
  <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <ins class="adsbygoogle"
       style="display:inline-block;width:320px;height:50px"
       data-ad-client=""
       data-ad-slot=""></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div><!-- /.google-ads -->

<span>&copy; 2026 Justin D. Yeakel. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="//jdyeakel.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="//jdyeakel.github.io/assets/js/scripts.min.js"></script>


  
          

</body>
</html>
